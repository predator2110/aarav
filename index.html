<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ludo Game - Simple Web Version</title>
  <style>
    body { background: #f0f0f0; font-family: Arial, sans-serif; text-align: center; }
    h1 { margin-top: 20px; }
    #game { display: flex; flex-direction: column; align-items: center; }
    #board { display: grid; grid-template-columns: repeat(15, 32px); grid-template-rows: repeat(15, 32px); gap: 2px; background: #222; }
    .cell { width: 32px; height: 32px; background: #fff; border-radius: 6px; position: relative; }
    .home { background: #eee; }
    .red { background: #e74c3c; }
    .green { background: #27ae60; }
    .yellow { background: #f1c40f; }
    .blue { background: #2980b9; }
    .token {
      width: 20px; height: 20px;
      border-radius: 50%;
      position: absolute; top: 6px; left: 6px;
      border: 2px solid #fff;
      box-shadow: 0 0 2px #0006;
      cursor: pointer;
      z-index: 2;
    }
    .token.red { background: #c0392b; }
    .token.green { background: #229954; }
    .token.yellow { background: #b7950b; }
    .token.blue { background: #2471a3; }
    #dice { font-size: 2.2em; margin: 20px 0 10px 0; }
    #rollBtn { font-size: 1.3em; padding: 8px 24px; border-radius: 8px; border: none; background: #2980b9; color: #fff; cursor: pointer; }
    #rollBtn:disabled { background: #aaa; cursor: not-allowed; }
    #turn { font-size: 1.2em; margin: 10px 0; }
    #msg { margin: 8px 0; color: #c0392b; font-weight: bold; }
    .win { font-size: 1.4em; color: #27ae60; }
    /* Responsive */
    @media (max-width:600px) {
      #board { transform: scale(0.65); }
    }
  </style>
</head>
<body>
  <h1>Simple Ludo Game (4 Players)</h1>
  <div id="game">
    <div id="board"></div>
    <div id="dice">ðŸŽ²</div>
    <button id="rollBtn">Roll Dice</button>
    <div id="turn"></div>
    <div id="msg"></div>
    <div id="winner" class="win"></div>
  </div>
  <script>
    // --- Ludo Board Path Data ---
    // Each cell: {x, y} on 15x15 grid
    // Each player: home positions, start, path, home column
    const BOARD_SIZE = 15;
    const PLAYER_COLORS = ['red', 'green', 'yellow', 'blue'];
    // Path for each player (clockwise, starting at different points)
    const PATHS = [
      // Red
      [
        {x:6,y:14},{x:6,y:13},{x:6,y:12},{x:6,y:11},{x:6,y:10},{x:5,y:9},
        {x:4,y:9},{x:3,y:9},{x:2,y:9},{x:1,y:9},{x:0,y:9},{x:0,y:8},
        {x:1,y:8},{x:2,y:8},{x:3,y:8},{x:4,y:8},{x:5,y:8},{x:6,y:7},
        {x:6,y:6},{x:7,y:6},{x:8,y:6},{x:8,y:7},{x:9,y:8},{x:9,y:9},
        {x:9,y:10},{x:9,y:11},{x:9,y:12},{x:9,y:13},{x:9,y:14},{x:8,y:14},
        {x:7,y:14},{x:6,y:14}, // 31
        // Home column
        {x:7,y:13},{x:7,y:12},{x:7,y:11},{x:7,y:10},{x:7,y:9},{x:7,y:8}
      ],
      // Green
      [
        {x:0,y:8},{x:1,y:8},{x:2,y:8},{x:3,y:8},{x:4,y:8},{x:5,y:8},
        {x:6,y:7},{x:6,y:6},{x:7,y:6},{x:8,y:6},{x:9,y:6},{x:9,y:5},
        {x:9,y:4},{x:9,y:3},{x:9,y:2},{x:9,y:1},{x:9,y:0},{x:10,y:0},
        {x:10,y:1},{x:10,y:2},{x:10,y:3},{x:10,y:4},{x:10,y:5},{x:11,y:6},
        {x:12,y:6},{x:13,y:6},{x:14,y:6},{x:14,y:7},{x:13,y:7},{x:12,y:7},
        {x:11,y:7},{x:10,y:7},{x:9,y:7}, // 32
        // Home column
        {x:9,y:8},{x:9,y:9},{x:9,y:10},{x:9,y:11},{x:9,y:12},{x:9,y:13}
      ],
      // Yellow
      [
        {x:8,y:0},{x:8,y:1},{x:8,y:2},{x:8,y:3},{x:8,y:4},{x:8,y:5},
        {x:8,y:6},{x:9,y:6},{x:10,y:6},{x:11,y:6},{x:12,y:6},{x:13,y:6},
        {x:14,y:6},{x:14,y:7},{x:13,y:7},{x:12,y:7},{x:11,y:7},{x:10,y:7},
        {x:9,y:7},{x:8,y:7},{x:8,y:8},{x:7,y:8},{x:6,y:9},{x:5,y:9},
        {x:4,y:9},{x:3,y:9},{x:2,y:9},{x:1,y:9},{x:0,y:9},{x:0,y:8},
        {x:1,y:8},{x:2,y:8},{x:3,y:8}, // 32
        // Home column
        {x:8,y:9},{x:8,y:10},{x:8,y:11},{x:8,y:12},{x:8,y:13},{x:8,y:14}
      ],
      // Blue
      [
        {x:14,y:7},{x:13,y:7},{x:12,y:7},{x:11,y:7},{x:10,y:7},{x:9,y:7},
        {x:8,y:7},{x:8,y:8},{x:7,y:8},{x:6,y:9},{x:5,y:9},{x:4,y:9},
        {x:3,y:9},{x:2,y:9},{x:1,y:9},{x:0,y:9},{x:0,y:8},{x:1,y:8},
        {x:2,y:8},{x:3,y:8},{x:4,y:8},{x:5,y:8},{x:6,y:7},{x:7,y:6},
        {x:8,y:6},{x:9,y:6},{x:10,y:6},{x:11,y:6},{x:12,y:6},{x:13,y:6},
        {x:14,y:6},{x:14,y:7},{x:14,y:8}, // 32
        // Home column
        {x:13,y:7},{x:12,y:7},{x:11,y:7},{x:10,y:7},{x:9,y:7},{x:8,y:7}
      ]
    ];
    // Home positions for each player (4 tokens)
    const HOME_POS = [
      [ {x:1,y:13}, {x:1,y:11}, {x:3,y:13}, {x:3,y:11} ], // Red
      [ {x:1,y:1}, {x:1,y:3}, {x:3,y:1}, {x:3,y:3} ],     // Green
      [ {x:13,y:1}, {x:11,y:1}, {x:13,y:3}, {x:11,y:3} ], // Yellow
      [ {x:13,y:13}, {x:13,y:11}, {x:11,y:13}, {x:11,y:11} ] // Blue
    ];
    // Start index for each player on their path
    const START_INDEX = [0,0,0,0];
    // Home entry index for each player
    const HOME_ENTRY = [31,31,31,31];
    // Safe cells (no capturing)
    const SAFE_CELLS = [
      {x:6,y:14},{x:0,y:8},{x:8,y:0},{x:14,y:6},
      {x:8,y:14},{x:14,y:8},{x:6,y:0},{x:0,y:6}
    ];

    // --- Game State ---
    let tokens = [
      // Each: {pos: -1 (home), pathIndex: null, finished: false}
      [ {pos:-1, pathIndex:null, finished:false}, {pos:-1, pathIndex:null, finished:false}, {pos:-1, pathIndex:null, finished:false}, {pos:-1, pathIndex:null, finished:false} ], // Red
      [ {pos:-1, pathIndex:null, finished:false}, {pos:-1, pathIndex:null, finished:false}, {pos:-1, pathIndex:null, finished:false}, {pos:-1, pathIndex:null, finished:false} ], // Green
      [ {pos:-1, pathIndex:null, finished:false}, {pos:-1, pathIndex:null, finished:false}, {pos:-1, pathIndex:null, finished:false}, {pos:-1, pathIndex:null, finished:false} ], // Yellow
      [ {pos:-1, pathIndex:null, finished:false}, {pos:-1, pathIndex:null, finished:false}, {pos:-1, pathIndex:null, finished:false}, {pos:-1, pathIndex:null, finished:false} ]  // Blue
    ];
    let currentPlayer = 0;
    let diceValue = null;
    let canRoll = true;
    let winnerList = [];
    let consecutiveSix = 0;

    // --- Utility Functions ---
    function cellKey(x, y) { return `${x},${y}`; }
    function isSafeCell(x, y) {
      return SAFE_CELLS.some(c => c.x === x && c.y === y);
    }

    // --- Board Render ---
    function renderBoard() {
      const board = document.getElementById('board');
      board.innerHTML = '';
      // Draw 15x15 grid
      for (let y = 0; y < BOARD_SIZE; y++) {
        for (let x = 0; x < BOARD_SIZE; x++) {
          let cell = document.createElement('div');
          cell.className = 'cell';
          // Home areas
          if (x < 6 && y < 6) cell.classList.add('green','home');
          if (x > 8 && y < 6) cell.classList.add('yellow','home');
          if (x < 6 && y > 8) cell.classList.add('red','home');
          if (x > 8 && y > 8) cell.classList.add('blue','home');
          // Center
          if (x >= 6 && x <= 8 && y >= 6 && y <= 8) cell.classList.add('home');
          // Safe cells
          if (isSafeCell(x, y)) cell.style.border = '2px solid #27ae60';
          // Home columns
          if (x === 7 && y > 0 && y < 6) cell.classList.add('green');
          if (y === 7 && x > 8 && x < 14) cell.classList.add('yellow');
          if (x === 7 && y > 8 && y < 14) cell.classList.add('red');
          if (y === 7 && x > 0 && x < 6) cell.classList.add('blue');
          board.appendChild(cell);
        }
      }
      // Draw tokens
      for (let p = 0; p < 4; p++) {
        for (let t = 0; t < 4; t++) {
          let token = tokens[p][t];
          let pos;
          if (token.pos === -1) pos = HOME_POS[p][t];
          else if (token.finished) continue;
          else pos = PATHS[p][token.pathIndex];
          let idx = pos.y * BOARD_SIZE + pos.x;
          let cell = board.children[idx];
          let el = document.createElement('div');
          el.className = `token ${PLAYER_COLORS[p]}`;
          el.title = `Player ${p+1}, Token ${t+1}`;
          if (currentPlayer === p && diceValue && isMovable(p, t)) {
            el.style.outline = '2px solid #fff';
            el.style.boxShadow = '0 0 8px #fff';
            el.onclick = () => moveToken(p, t);
            el.style.cursor = 'pointer';
          }
          cell.appendChild(el);
        }
      }
    }

    // --- Dice ---
    function rollDice() {
      if (!canRoll) return;
      diceValue = Math.floor(Math.random()*6)+1;
      document.getElementById('dice').textContent = `ðŸŽ² ${diceValue}`;
      document.getElementById('msg').textContent = '';
      canRoll = false;
      // Check if any move possible
      let movable = false;
      for (let t = 0; t < 4; t++) {
        if (isMovable(currentPlayer, t)) movable = true;
      }
      if (!movable) {
        setTimeout(nextTurn, 1100);
        document.getElementById('msg').textContent = 'No moves, next player...';
      }
      renderBoard();
    }

    // --- Move Logic ---
    function isMovable(player, tokenIdx) {
      let token = tokens[player][tokenIdx];
      if (token.finished) return false;
      if (token.pos === -1) {
        // In home
        return diceValue === 6;
      } else {
        // On board
        let next = token.pathIndex + diceValue;
        // Check home entry
        if (next > HOME_ENTRY[player]+6) return false;
        return true;
      }
    }

    function moveToken(player, tokenIdx) {
      if (player !== currentPlayer || !diceValue || !isMovable(player, tokenIdx)) return;
      let token = tokens[player][tokenIdx];
      if (token.pos === -1 && diceValue === 6) {
        // Unlock from home
        token.pos = 0;
        token.pathIndex = START_INDEX[player];
      } else if (token.pos !== -1) {
        // Move ahead
        token.pathIndex += diceValue;
        // Home entry
        if (token.pathIndex > HOME_ENTRY[player]+6) {
          token.pathIndex -= diceValue; // Can't move
          document.getElementById('msg').textContent = 'Move not possible!';
          return;
        }
        // Home reached
        if (token.pathIndex === HOME_ENTRY[player]+6) {
          token.finished = true;
        }
        // Capturing
        let pos = PATHS[player][token.pathIndex];
        if (!isSafeCell(pos.x, pos.y)) {
          for (let op = 0; op < 4; op++) {
            if (op === player) continue;
            for (let ot = 0; ot < 4; ot++) {
              let otok = tokens[op][ot];
              if (otok.finished || otok.pos === -1) continue;
              let opos = PATHS[op][otok.pathIndex];
              if (opos.x === pos.x && opos.y === pos.y) {
                otok.pos = -1; otok.pathIndex = null;
                document.getElementById('msg').textContent = `Captured Player ${op+1}'s token!`;
              }
            }
          }
        }
      }
      // Check win
      let finishedCount = tokens[player].filter(t=>t.finished).length;
      if (finishedCount === 4 && !winnerList.includes(player)) {
        winnerList.push(player);
        document.getElementById('winner').textContent += `Player ${player+1} (${PLAYER_COLORS[player]}) finished! `;
      }
      // Dice logic
      if (diceValue === 6) {
        consecutiveSix++;
        if (consecutiveSix < 3) {
          canRoll = true;
          document.getElementById('msg').textContent = 'Rolled 6! Roll again.';
        } else {
          consecutiveSix = 0;
          nextTurn();
        }
      } else {
        consecutiveSix = 0;
        nextTurn();
      }
      diceValue = null;
      renderBoard();
    }

    function nextTurn() {
      diceValue = null;
      canRoll = true;
      do {
        currentPlayer = (currentPlayer+1)%4;
      } while (winnerList.includes(currentPlayer) && winnerList.length < 4);
      document.getElementById('dice').textContent = 'ðŸŽ²';
      document.getElementById('msg').textContent = '';
      renderBoard();
      updateTurn();
      // Game over
      if (winnerList.length === 4) {
        document.getElementById('msg').textContent = '';
        document.getElementById('turn').textContent = '';
        document.getElementById('winner').textContent = 'Game Over!';
        document.getElementById('rollBtn').disabled = true;
      }
    }

    function updateTurn() {
      document.getElementById('turn').innerHTML =
        `<span style="color:${PLAYER_COLORS[currentPlayer]}">Player ${currentPlayer+1}'s turn</span>`;
      document.getElementById('rollBtn').disabled = !canRoll;
    }

    // --- Init ---
    document.getElementById('rollBtn').onclick = rollDice;
    renderBoard();
    updateTurn();
  </script>
</body>
</html>
